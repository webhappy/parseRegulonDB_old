{
    "contents" : "allData <- read.csv('selected.csv')\nlibrary('edgeR')\nlibrary(ggplot2)\n\ncounts <- allData[,-1]\nrownames(allData) <- allData$seq\n\ntemp <- DGEList(counts=counts, group=factor(1:ncol(counts)), genes=allData[,1])\ntemp <- calcNormFactors(temp)\ncountsNormalized <- counts\nfor (i in 1:ncol(temp)) {  countsNormalized[,i] <- counts[,i] * temp$samples$norm.factors[i] }\n\n### investigate the Norflax data\nplot(countsNormalized$X1_aerobic_t180_6_Nor, countsNormalized$X2_aerobic_t180_6_nor,xlab='Rep 1, t180_Norflox',ylab='Rep 2, t180_Norflox')\nextremePt <- countsNormalized$X1_aerobic_t180_6_Nor > 40000\nplot(countsNormalized$X1_aerobic_t180_6_Nor[!extremePt], countsNormalized$X2_aerobic_t180_6_nor[!extremePt],xlab='Rep 1, t180_Norflox',ylab='Rep 2, t180_Norflox')\n\n### determine if Nor is changing\n\n#countsNormalized <- countsNormalized + 1\nsubset <- countsNormalized[ , c('X1_aerobic_t30_6_nor','X1_aerobic_t60_6_nor','X1_aerobic_t180_6_Nor') ]\nsubset <- apply(subset, 2, function(x) x/countsNormalized$X1_aerobic_t0_1_control)\nsubset[countsNormalized$X1_aerobic_t0_1_control < .001, ] <- NA\nsummary(subset)\n#subset <- subset[subset[,3]<500,]\nboxplot(log(subset[,3]))\n\nenriched <- allData[subset[,3]>10 & !is.na(subset[,3]), c('seq', 'X1_aerobic_t0_1_control','X1_aerobic_t30_6_nor','X1_aerobic_t60_6_nor','X1_aerobic_t180_6_Nor')]\ndepleted <-allData[subset[,3]<.1 & !is.na(subset[,3]) & allData[,'X1_aerobic_t0_1_control']>20, c('seq', 'X1_aerobic_t0_1_control','X1_aerobic_t30_6_nor','X1_aerobic_t60_6_nor','X1_aerobic_t180_6_Nor')]\n\napply(counts,2,function(x){sum(x==0)})\ncolSums(counts)\n\n### convert to frequencies ####\npar(mar=c(7,5,1,1))\nboxplot(counts,las=2)\nfreqs <- apply(counts, 2, function(x){return(x/sum(x))})\nfreqs <- data.frame(freqs)\n\n### convert to adjustedCounts ####\ncountsNormalized <- data.frame(apply(counts, 2, function(x){return(x*2000000/sum(x))}))\n\n# adjusted pseudo counts ####\ncountsNormalized <- data.frame(apply(counts, 2, function(x){x=x+1;return(x*2000000/sum(x))}))\nratios <- data.frame(ratio30=countsNormalized$X1_aerobic_t30_2_chlor/countsNormalized$X1_aerobic_t30_1_control,\n                     ratio60=countsNormalized$X1_aerobic_t60_2_chlor/countsNormalized$X1_aerobic_t60_1_control,\n                     ratio180=countsNormalized$X1_aerobic_t180_2_chlor/countsNormalized$X1_aerobic_t180_1_control,\n                     chlor30=countsNormalized$X1_aerobic_t30_2_chlor,chlor60=countsNormalized$X1_aerobic_t60_2_chlor,chlor180=countsNormalized$X1_aerobic_t180_2_chlor,\n                     cont0=countsNormalized$X1_aerobic_t0_1_control,cont30=countsNormalized$X1_aerobic_t30_1_control,cont60=countsNormalized$X1_aerobic_t60_1_control,\n                     cont180=countsNormalized$X1_aerobic_t180_1_control,row.names=allData$seq)\nratios <- data.frame(ratio30=countsNormalized$X1_aerobic_t30_2_chlor/countsNormalized$X1_aerobic_t30_1_control,\n                     ratio60=countsNormalized$X1_aerobic_t60_2_chlor/countsNormalized$X1_aerobic_t60_1_control,\n                     ratio180=countsNormalized$X1_aerobic_t180_2_chlor/countsNormalized$X1_aerobic_t180_1_control,\n                     wt30=sqrt(countsNormalized$X1_aerobic_t30_2_chlor+countsNormalized$X1_aerobic_t30_1_control),\n                     wt60=sqrt(countsNormalized$X1_aerobic_t60_2_chlor+countsNormalized$X1_aerobic_t60_1_control),\n                     wt180=sqrt(countsNormalized$X1_aerobic_t180_2_chlor+countsNormalized$X1_aerobic_t180_1_control)                     )\nscores <- apply(ratios, 1, function(x){(x[1]*x[4]+x[2]*x[5]+x[3]*x[6])/sum(x[4:6])})\nratios <- data.frame(ratio30=countsNormalized$X1_aerobic_t30_2_chlor/countsNormalized$X1_aerobic_t30_1_control,\n                     ratio60=countsNormalized$X1_aerobic_t60_2_chlor/countsNormalized$X1_aerobic_t60_1_control,\n                     ratio180=countsNormalized$X1_aerobic_t180_2_chlor/countsNormalized$X1_aerobic_t180_1_control,\n                     chlor30=countsNormalized$X1_aerobic_t30_2_chlor,chlor60=countsNormalized$X1_aerobic_t60_2_chlor,chlor180=countsNormalized$X1_aerobic_t180_2_chlor,\n                     cont0=countsNormalized$X1_aerobic_t0_1_control,cont30=countsNormalized$X1_aerobic_t30_1_control,cont60=countsNormalized$X1_aerobic_t60_1_control,\n                     cont180=countsNormalized$X1_aerobic_t180_1_control,row.names=allData$seq)\nratios$scores <- scores\npairs(log2(ratios[,1:3]))\n\n\nenriched <- freqs[,3]/freqs$X1_aerobic_t0_1_control\n\n",
    "created" : 1399846673347.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2662016514",
    "id" : "F37A8BF6",
    "lastKnownWriteTime" : 1400373413,
    "path" : "~/PycharmProjects/parseRegulonDB/diffExpression/investigate_0508.R",
    "project_path" : "investigate_0508.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}