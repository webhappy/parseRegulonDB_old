library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
View(genes)
hist(genes$avg_lr)
library(ggplot)
qplot(genes$avg_lr,color=genes$operon_pos)+geom_density()
library(ggplot)
library(ggplot2)
qplot(genes$avg_lr,color=genes$operon_pos)+geom_density()
qplot(genes$avg_lr,color=genes$operon_pos,geom='density')
View(genes)
summary(genes$avg_lr)
genes <- genes[!is.na(genes$avg_lr),]
summary(genes$avg_lr)
qplot(genes$avg_lr,color=genes$operon_pos,geom='density')
qplot(genes$avg_lr)
genes <- genes[!is.na(genes$avg_lr) & genes$operon_pos>0,]
hist(genes$avg_lr)
qplot(genes$avg_lr,color=genes$operon_pos,geom='density')
summary(genes)
qplot(genes$avg_lr)
qplot(genes$avg_lr,geom='density')
qplot(genes$avg_lr,color=genes$operon_pos,geom='density')
qplot(genes$avg_lr,geom='density',color=genes$operon_pos)
genes$operon_pos <- as.factor(genes$operon_pos)
summary(genes)
qplot(genes$avg_lr,geom='density',color=genes$operon_pos)
hist(genes$operon_pos)
bar(genes$operon_pos)
barplot(genes$operon_pos)
barplot(table(genes$operon_pos))
qplot(data=genes[genes$operon_pos<10,], avg_lr,geom='density',color=operon_pos)
data=genes[genes$operon_pos<10,],
data=genes[genes$operon_pos<10,]
data=genes[as.numeric(genes$operon_pos) < 10,]
qplot(data=data, avg_lr,geom='density',color=operon_pos)
barplot(table(genes$operon_pos))
qplot(data=data, avg_lr,geom='density',color=operon_pos)
table(genes$operon_pos)
data=genes[as.numeric(genes$operon_pos) < 7,]
qplot(data=data, avg_lr,geom='density',color=operon_pos)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
summary(sgRNAs)
sgRNAs$operon_pos <- as.factor(sgRNAs$operon_pos)
sgRNAs$geneName <- as.factor(sgRNAs$geneName)
hist(sgRNAs$avg_lr)
qplot(sgRNAs$avg_lr)
qplot(sgRNAs$avg_lr)
qplot(sgRNAs$normalized_lr)
summary(sgRNAs)
nlevels(sgRNAs$geneName)
qplot(sgRNAs$avg_lr)
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",sub="Each gene has one sgRNA with effect size=1")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",main="Normalized distribution of sgRNAs",sub="Each gene has one sgRNA with effect size=1")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",main="Normalized distribution of sgRNAs")+ggtitle(expression(atop("Each gene has one sgRNA with effect size=1")))
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")+ggtitle(expression(atop("Normalized distribution of sgRNAs",atop(Each gene has one sgRNA with effect size=1"))))
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")+ggtitle(expression(atop("Normalized distribution of sgRNAs",atop("Each gene has one sgRNA with effect size=1"))))
badSgRNAs_normalized <- sgRNAs[sgRNAs$normalized_lr < .3, ]
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -2]
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -2,]
sgRNAs$isBad <- sgRNAs$normalized_lr < .3
summary(sgRNAs)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)
boxplot(sgRNAs$distance_ATG ~ sgRNAs$isBad)
boxplot(sgRNAs$distance_ATG ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="Is bad?")
sgRNAs$isBad <- factor(sgRNAs$isBad, levels=c(FALSE,TRUE),labels=c("Good sgRNA","Bad sgRNA"))
boxplot(sgRNAs$distance_ATG ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="sgRNA has normalized effect > .3")
boxplot(sgRNAs$operon_pos ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="sgRNA has normalized effect > .3")
plot(sgRNAs$operon_pos ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="sgRNA has normalized effect > .3")
plot(sgRNAs$operon_pos ~ sgRNAs$isBad,ylab="Operon position",xlab="sgRNA has normalized effect > .3")
barplot(sgRNAs$operon_pos ~ sgRNAs$isBad,ylab="Operon position",xlab="sgRNA has normalized effect > .3")
barplot(table(sgRNAs$operon_pos) ~ sgRNAs$isBad,ylab="Operon position",xlab="sgRNA has normalized effect > .3")
table(sgRNAs$operon_pos)
barplot(table(sgRNAs$operon_pos))
plot(table(sgRNAs$operon_pos) ~ sgRNAs$isBad,ylab="Operon position",xlab="sgRNA has normalized effect > .3")
table(sgRNAs$operon_pos~sgRNAs$isBad)
table(sgRNAs$operon_pos,sgRNAs$isBad)
plot(table(sgRNAs$operon_pos,sgRNAs$isBad))
plot(t(table(sgRNAs$operon_pos,sgRNAs$isBad)))
barplot(table(sgRNAs$operon_pos,sgRNAs$isBad))
qplot(sgRNAs$operon_pos,facets=sgRNAs$isBad)
qplot(sgRNAs$operon_pos,facets=sgRNAs$isBad,geom="bar")
qplot(sgRNAs$operon_pos,facets=sgRNAs$isBad ~ .,geom="bar")
qplot(sgRNAs$operon_pos,facets=sgRNAs$isBad ~ .,geom="histogram")
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram")
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status not a function of operon position")
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
scale_colour_manual(values=cbPalette)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
scale_fill_manual(values=cbPalette)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
scale_density_manual(values=cbPalette)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_color_brewer(palette=cbPalette)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_color_brewer(palette="Set1")
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_color_brewer(palette="Set2")
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_color_brewer(palette="Set3")
scale_color_manual(values=cbPalette)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='hist',color=sgRNAs$isBad)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='histogram',color=sgRNAs$isBad)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
scale_fill_manual(values=cbPalette)
scale_colour_manual(values=cbPalette)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
genes <- genes[!is.na(genes$avg_lr) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes$avg_lr)
summary(genes)
library(ggplot2)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# To use for fills, add
scale_fill_manual(values=cbPalette)
# To use for line and point colors, add
scale_colour_manual(values=cbPalette)
data=genes[as.numeric(genes$operon_pos) < 7,]
qplot(data=data, avg_lr,geom='density',color=operon_pos)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
sgRNAs$operon_pos <- as.factor(sgRNAs$operon_pos)
sgRNAs$geneName <- as.factor(sgRNAs$geneName)
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")+ggtitle(expression(atop("Normalized distribution of sgRNAs",atop("Each gene has one sgRNA with effect size=1"))))
summary(sgRNAs)
nlevels(sgRNAs$geneName)
badSgRNAs_normalized <- sgRNAs[sgRNAs$normalized_lr < .3, ]
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -2,]
sgRNAs$isBad <- sgRNAs$normalized_lr < .3
sgRNAs$isBad <- factor(sgRNAs$isBad, levels=c(FALSE,TRUE),labels=c("Good sgRNA","Bad sgRNA"))
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_color_brewer(palette="Set3")
boxplot(sgRNAs$distance_ATG ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="sgRNA has normalized effect > .3")
plot(table(sgRNAs$operon_pos) ~ sgRNAs$isBad,ylab="Operon position",xlab="sgRNA has normalized effect > .3")
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)+scale_fill_manual(values=cbPalette)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)+scale_colour_manual(values=cbPalette)
scale_color_manual(values=cbPalette)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_colour_manual(values=cbPalette)
library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
genes <- genes[!is.na(genes$avg_lr) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes$avg_lr)
hist(genes$avg_lr,xlab="Average fitness effect at each gene",main="Averaging over all replicates and sgRNA's for each gene")
library(ggplot2)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
qplot(data=data, avg_lr,geom='density',color=operon_pos)
library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
genes <- genes[!is.na(genes$avg_lr) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes$avg_lr,xlab="Average fitness effect at each gene",main="Averaging over all replicates and sgRNA's for each gene")
summary(genes)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
sgRNAs$operon_pos <- as.factor(sgRNAs$operon_pos)
sgRNAs$geneName <- as.factor(sgRNAs$geneName)
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
library(ggplot2)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")+ggtitle(expression(atop("Normalized distribution of sgRNAs",atop("Each gene has one sgRNA with effect size=1"))))
summary(sgRNAs)
nlevels(sgRNAs$geneName)
badSgRNAs_normalized <- sgRNAs[sgRNAs$normalized_lr < .3, ]
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -2,]
badSgRNAs_normalized <- sgRNAs[sgRNAs$normalized_lr < .3, ]
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -2,]
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA",geom='density')
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -16*.3,]
-16*.3
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -5,]
sgRNAs$isBad <- sgRNAs$normalized_lr < .3
sgRNAs$isBad <- factor(sgRNAs$isBad, levels=c(FALSE,TRUE),labels=c("Good sgRNA","Bad sgRNA"))
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)+scale_colour_manual(values=cbPalette)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_colour_manual(values=cbPalette)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,binwidth=1,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,binwidth=2,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,binwidth=.8,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,binwidth=.2,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,binwidth=.5,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
summary(sgRNAs)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+xlim(1,15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+xlim(0,15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+xlim(1,15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+xlim(.5,15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")
1:15
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(1:15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(1:15)+xlim(1,15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(1:15)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(1:13)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(.5:13)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(2:13)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(1:13)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete(1:2:13)
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete()
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_continuous()
qplot(operon_pos,data=sgRNAs,facets=isBad ~ .,geom="histogram",xlab="Operon position for gene",main="Bad status is not a function of operon position")+scale_x_discrete()
library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
genes <- genes[!is.na(genes$avg_lr) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes$avg_lr,xlab="Average fitness effect at each gene",main="Averaging over all replicates and sgRNA's for each gene")
summary(genes)
library(ggplot2)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# To use for fills, add
scale_fill_manual(values=cbPalette)
# To use for line and point colors, add
scale_color_manual(values=cbPalette)
data=genes[as.numeric(genes$operon_pos) < 7,]
qplot(data=data, avg_lr,geom='density',color=operon_pos)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
sgRNAs$operon_pos <- as.factor(sgRNAs$operon_pos)
sgRNAs$geneName <- as.factor(sgRNAs$geneName)
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")+ggtitle(expression(atop("Normalized distribution of sgRNAs",atop("Each gene has one sgRNA with effect size=1"))))
summary(sgRNAs)
nlevels(sgRNAs$geneName)
View(sgRNAs)
tail(sgRNAs)
summary(sgRNAs$geneName)
nlevels(sgRNAs$geneName)
View(sgRNAs)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
nlevels(sgRNAs$geneName)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
summary(sgRNAs$geneName)
length(sgRNAs$geneName)
unique(sgRNAs$geneName)
library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
genes <- genes[!is.na(genes$avg_lr) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes$avg_lr,xlab="Average fitness effect at each gene",main="Averaging over all replicates and sgRNA's for each gene")
genes <- dbReadTable(con, 'GENE')
View(genes)
hist(genes$logFC)
hist(genes[genes$operon_pos==1,logFC])
hist(genes[genes$operon_pos==1,]$logFC)
library(RMySQL)
con <- dbConnect(MySQL(),user="root",dbname="t")
genes <- dbReadTable(con, 'GENE')
hist(genes[genes$operon_pos==1,]$logFC)
genes <- genes[!is.na(genes$logFC) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes[genes$operon_pos==1,]$logFC)
genes <- genes[!is.na(genes$logFC) & genes$operon_pos>0,]
genes <- dbReadTable(con, 'GENE')
hist(genes[genes$operon_pos==1,]$logFC)
genes$logFC <- genes$median
hist(genes[genes$operon_pos==1,]$logFC)
genes <- genes[!is.na(genes$logFC) & genes$operon_pos>0,]
genes$operon_pos <- as.factor(genes$operon_pos)
table(genes$operon_pos)
hist(genes$avg_lr,xlab="Average fitness effect at each gene",main="Averaging over all replicates and sgRNA's for each gene")
summary(genes)
library(ggplot2)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# To use for fills, add
scale_fill_manual(values=cbPalette)
# To use for line and point colors, add
scale_color_manual(values=cbPalette)
data=genes[as.numeric(genes$operon_pos) < 7,]
qplot(data=data, avg_lr,geom='density',color=operon_pos)
sgRNAs <- read.csv('sgRNAs_in_essential_genes.csv')
sgRNAs$operon_pos <- as.factor(sgRNAs$operon_pos)
sgRNAs$geneName <- as.factor(sgRNAs$geneName)
qplot(sgRNAs$avg_lr,xlab="Average effect of each sgRNA")
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene")+ggtitle(expression(atop("Normalized distribution of sgRNAs",atop("Each gene has one sgRNA with effect size=1"))))
summary(sgRNAs)
nlevels(sgRNAs$geneName)
qplot(sgRNAs$normalized_lr,xlab="Average effect of each sgRNA normalized to strongest sgRNA for each gene",geom='density',color=sgRNAs$isBad)+scale_colour_manual(values=cbPalette)
qplot(sgRNAs$distance_ATG,xlab="Distance for each sgRNA from ATG",geom='density',color=sgRNAs$isBad)+scale_colour_manual(values=cbPalette)
boxplot(sgRNAs$distance_ATG ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="sgRNA has normalized effect > .3")
badSgRNAs_normalized <- sgRNAs[sgRNAs$normalized_lr < .3, ]
badSgRNAs <- sgRNAs[ sgRNAs$avg_lr > -5,]
-16*.3
sgRNAs$isBad <- sgRNAs$normalized_lr < .3
sgRNAs$isBad <- factor(sgRNAs$isBad, levels=c(FALSE,TRUE),labels=c("Good sgRNA","Bad sgRNA"))
boxplot(sgRNAs$distance_ATG ~ sgRNAs$isBad,ylab="Distance from ATG",xlab="sgRNA has normalized effect > .3")
summary(sgRNAs)
